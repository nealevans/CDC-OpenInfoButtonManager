function applyEllipsis(){function n(n){var r=$(n).width()-1e4,t,f,i,u,e;if(!(r<0)){for(t=$(n).html(),f=$(n).text(),$(n).html("<span>"+t+"<\/span>"),i=n.firstChild,u=!1,t.length&&$(i).width()>r&&(e=r/$(i).width(),t=t.substr(0,t.length*e),$(i).html(t+"..."),u=!0);t.length&&$(i).width()>=r;)t=t.substr(0,t.length-1),$(i).html(t+"..."),u=!0;u&&(n.title=f),$(n).addClass("ellipsisDone")}}function t(n){$(n).removeClass("ellipsis").removeClass("ellipsisDone")}$(".ellipsis").each(function(){n(this)}),$(".ellipsisDone").each(function(){t(this)})}function openCenteredWindow(n,t,i,r,u){var o=Math.floor((screen.availWidth-i)/2),s=Math.floor((screen.availHeight-t)/2),e="top="+s+",left="+o+",height="+t+",width="+i,f;return u&&(e+=","+u),f=window.open(n,r,e),f&&f.focus(),f}function htmlEncode(n){return $("<div/>").text(n).html()}function htmlDecode(n){return $("<div/>").html(n).text()}function getQueryParameterByName(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i="[\\?&]"+n+"=([^&#]*)",r=new RegExp(i),t=r.exec(window.location.href);return t==null?"":decodeURIComponent(t[1].replace(/\+/g," "))}function showNotificationBar(n){var t=2e3;$("#notificationBar").length==0&&$("body").append("<div id='notificationBar'>"+n+"<\/div>"),$("#notificationBar").slideDown(function(){setTimeout(function(){$("#notificationBar").slideUp()},t)})}var global={},hashManager;$(document).ready(function(){global.window=$(window),global.document=$("body"),global.dialogWidth=700,global.messageBoxWidth=400,global.topMostZindex=100,global.lightBoxIndex=0,global.animationSpeed=400,global.focusKeeper=null,global.focusKeeperExceptions=["#ui-datepicker-div"]}),typeof hv=="undefined"&&(hv={}),hv.log=function(n,t){typeof t!="undefined"&&(n=n.replace(/(count=)[^\&]+/,"$1"+t)),$.get(n)},function(){var n,t,i,r;hv.autoTimeout=function(u,f){i=u,r=f,t=function(){window.location.href=r},n=setTimeout(t,i);$(document).on("click keypress",function(){resetInactivityTimeout()})},window.resetInactivityTimeout=function(){clearTimeout(n),n=setTimeout(t,i)}}(),hashManager=new function(){var n;this.setKey=function(t,i){n[t]=i,this.push()},this.removeKey=function(t){delete n[t],this.push()},this.getKey=function(t){return n[t]},this.keyExists=function(t){return n.hasOwnProperty(t)},this.push=function(){var r=[],t,i;for(t in n)t&&n.hasOwnProperty(t)&&(t=encodeURIComponent(t),i=encodeURIComponent(n[t]),r.push(t+(i!=="undefined"?"="+i:"")));window.location.hash=r.join("&")},(this.load=function(){var t,u,i,r;for(n={},t=window.location.hash,t=t.substring(1,t.length),u=t.split("&"),r=0;r<u.length;r++)i=u[r].split("="),n[decodeURIComponent(i[0])]=typeof i[1]!="undefined"?decodeURIComponent(i[1]):i[1]})()},function(n){n.fn.keepFocus=function(){if(!this||!this.length)return this;global.focusKeeper&&global.focusKeeper.releaseFocus();var t=this.first(),r=function(r){var u=n(r.target);if(!t.has(u).length){for(i in global.focusKeeperExceptions)if(u.is(global.focusKeeperExceptions[i])||n(global.focusKeeperExceptions[i]).has(u).length)return;t.focusFirst()}};return t.data("keepFocus",r),n(document).focusin(r),global.focusKeeper=t,this},n.fn.releaseFocus=function(){if(!this||!this.length)return this;var t=this.first(),i=t.data("keepFocus");return typeof i=="function"&&n(document).unbind("focusin",i),t.removeData("keepFocus"),global.focusKeeper=null,this},n.fn.focusFirst=function(){var n=this.find("a[href], :input, [tabindex]").filter(":visible").first();if(n.length){if(n.filter("[tabindex]").length&&n.attr("tabindex")===undefined)return this;n.focus()}return this},n.fn.toggleImageLink=function(t){var i={source:n(this),hoverString:"-hover",selectedCssClass:"selected"},r;i=n.extend(i,t),i.source.hasClass(i.selectedCssClass)||(r=i.source.find("img"),i.source.mouseenter(function(){r.attr("src",r.attr("src").replace(/([^.]*)\.(.*)/,"$1"+i.hoverString+".$2"))}),i.source.mouseleave(function(){r.attr("src",r.attr("src").replace(i.hoverString,""))}))},n.fn.watermark=function(t){return!this||!this.length?this:(n(this).each(function(){var u,i,f,r,e;if(!n(this).is(":visible"))return this;if(u=t,(!u||u=="")&&(u=n(this).attr("watermark"),!u||u==""))return n(this).removeAttr("watermark"),this;i=n(this),i.is("[watermarked]")?(f=i.next(".watermark"),f.remove()):i.attr("watermarked","true"),i.after("<div class='watermark'><\/div>"),r=i.next(),r.css("left",i.position().left),r.css("top",i.position().top),r.css("height",i.outerHeight(!0)),e=i.outerHeight(!0)>206?26:i.outerHeight(!0),r.css("line-height",e+"px"),r.css("width",i.width()),r.click(function(){i.focus()}),i.val()!=""&&r.hide(),r.html(u),i.focus(function(){r.hide()}),i.change(function(){n(this).val()==""?r.show():r.hide()}),i.blur(function(){i.val()==""&&r.show()})}),this)},n.fn.displayVal=function(){if(this&&this.length)return n(this).filter("select").first().children("option[selected]").html()}}(jQuery),ko.bindingHandlers.slideDown={init:function(n,t){var i=t();$(n).toggle(ko.utils.unwrapObservable(i))},update:function(n,t){var i=t();ko.utils.unwrapObservable(i)?$(n).slideDown():$(n).slideUp()}},ko.bindingHandlers.watermark={init:function(n,t){var i=t();$(n).watermark(ko.utils.unwrapObservable(i))},update:function(n,t){var i=t();$(n).watermark(ko.utils.unwrapObservable(i))}},ko.bindingHandlers.submitClick={init:function(n,t,i,r,u){var f=t();if(typeof f!="function")throw new Error("The value for a submit binding must be a function");ko.utils.registerEventHandler(n,"click",function(){try{handlerReturnValue=f.call(u.$data,n)}finally{if(handlerReturnValue===!0){var i=$(n).closest("form");i.length>0&&i.valid()&&i.submit()}}})}},ko.utils.createObservableArrayOfType=function(n,t){var r,i;for(t=t||[],r=ko.observableArray(),i=0;i<t.length;i++)r.push(new n(t[i]));return r},ko.utils.createObservableArray=function(n,t){var r,i;for(n=n||[],r=ko.observableArray(),i=0;i<n.length;i++)r.push(t(n[i]));return r},ko.utils.expandableSection=function(n){var t=this;t.expanded=ko.observable(!!n),t.expand=function(){t.expanded(!t.expanded())}};var round=function(n,t){var i=parseFloat(n);return isNaN(i)?n:1*i.toFixed(t)},getUTCDate=function(n){return new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds())},getLocalDate=function(n){var t=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-t)},AjaxContent,Ajaxer;(function(){var n=function(){};Class=function(){},Class.create=function(t){var i=function(t){if(t!=n&&typeof this.init=="function")return this.init.apply(this,arguments)};i.prototype=new this(n);for(key in t)(function(n,t){i.prototype[key]=typeof n!="function"||typeof t!="function"?n:function(){return this.base=t,n.apply(this,arguments)}})(t[key],i.prototype[key]);return i.prototype.constructor=i,i.extend=this.extend||this.create,i}})(),function(n){n.fn.loadAppImageLogo=function(){return this.each(function(){n(this).append("<span><\/span>"),n("<img>").addClass("hide").appendTo(this).load(function(){this.width<=this.height&&this.height>100?n(this).css("height","100px"):(this.width>100||this.width==0)&&n(this).css("width","100px"),n(this).fadeIn()}).attr("src",n(this).attr("imgSrc")).attr("title",n(this).attr("imgTitle")).attr("alt",n(this).attr("imgTitle"))}),this},n.fn.directoryItemTooltip=function(){return this.each(function(){n(this).children("a[appid], a[deviceId]").tip({content:n(this).children("div.directoryItemTooltip"),position:"auto-h",width:300,delay:200})}),this}}(jQuery),AjaxContent=Class.create({timeoutHandle:null,init:function(n,t,i,r){this.elem=n,this.loadElem=t!=null?t:$("<div><\/div>"),this.emptyElem=i!=null?i:$("<div><\/div>"),this.errorElem=r!=null?r:$("<div><\/div>")},onInit:function(){var n=this;clearTimeout(n.timeoutHandle),n.timeoutHandle=setTimeout(function(){n.elem.hide(),n.emptyElem.hide(),n.errorElem.hide(),n.loadElem.show()},500)},onSuccess:function(n){var t=this;clearTimeout(t.timeoutHandle),t.errorElem.hide(),t.loadElem.hide(),n?(t.emptyElem.hide(),t.elem.show()):(t.elem.hide(),t.emptyElem.show())},onError:function(){var n=this;clearTimeout(n.timeoutHandle),n.elem.hide(),n.loadElem.hide(),n.emptyElem.hide(),n.errorElem.show()}}),Ajaxer=Class.create({init:function(n,t){this.content=n,this.options=t},execute:function(){var n=this;n.content.onInit(),$.ajax($.extend({type:"POST",url:n.options.url,cache:!1,data:$.extend({},n.options.data,g_antiForgeryToken),success:function(t){n.content.onSuccess(t)},error:function(){n.content.onError()}},n.options.ajax))}}),ko.bindingHandlers.widget={init:function(n,t){var i=t();ko.isObservable(i)&&i(n)}},ko.bindingHandlers.stopBinding={init:function(){return{controlsDescendantBindings:!0}}},ko.virtualElements.allowedBindings.stopBinding=!0,ko.bindingHandlers.enableButton={init:function(n,t){$(n).click(function(n){t()&&n.preventDefault()})},update:function(n,t){var i=ko.utils.unwrapObservable(t());i?$(n).enable():$(n).disable()}},function(n){function i(){var t=n(r),i=t.find(".bannerContent");t.appendTo(n("body")).css("z-index",10),this.show=function(n){i.html(u),i.load(n),t.show()},this.showWithContent=function(n){i.html(n.show()),t.show()},this.hide=function(){t.hide(),i.empty()},this.hideWithContent=function(n){t.hide(),n.detach()}}hv.popupBanner={};var r='<div class="hide bannerOverlay"><div class="bannerTable"><div class="bannerTableCell"><div class="bannerWrapper"><div class="bannerContent"><\/div><\/div><\/div><\/div><\/div>',u='<div class="loadingLightbox">&nbsp;<\/div>',t;hv.popupBanner.open=function(n){t||(t=new i),t.show(n)},hv.popupBanner.openWithContent=function(n){t||(t=new i),t.showWithContent(n)},hv.popupBanner.close=function(){t&&t.hide()},hv.popupBanner.closeWithContent=function(n){t&&t.hideWithContent(n)}}(jQuery),function(n){function r(){var n=createPageOverlay();this.show=function(){n.zIndex(global.topMostZindex),n.show();var i=global.window.width()/2-t.innerWidth()/2+global.window.scrollLeft(),r=global.window.height()/2-t.innerHeight()/2+global.window.scrollTop();t.css("left",i),t.css("top",r),t.css("z-index",global.topMostZindex+1),t.appendTo(n.baseElement.parent())},this.hide=function(){t.remove(),n.hide()}}hv.loadingOverlay={};var t=n('<div class="loadingLightbox">&nbsp;<\/div>'),i;hv.loadingOverlay.show=function(){i||(i=new r),i.show()},hv.loadingOverlay.hide=function(){i&&i.hide()}}(jQuery);function parseOnlyDate(n){for(i=0;i<g_dateFormats.length;i++)try{return $.datepicker.parseDate(g_dateFormats[i],n)}catch(t){}return null}function parseDateOrYear(n){return n=$.trim(n),n.length==4&&(n=n+"-12-31"),parseOnlyDate(n)}function findInputElement(n,t){var i,u,r;return n.length!=0&&(i=$(n).attr("name"),i.indexOf(".")>0&&(u=i.substring(0,i.lastIndexOf("."))+"."+t,r=$(":input[name='"+u+"']"),r.length!=0))?r:$(":input[name='"+t+"']")}var builtInRange,builtInDate;if($.validator){$.validator.methods.date=function(n,t){var i=parseOnlyDate(n),r=i!=null&&i.getFullYear()>=1e3&&i.getFullYear()<9999;return this.optional(t)&&(i==null||r)?!0:r},builtInRange=$.validator.methods.range,$.validator.methods.range=function(n,t,i){return $.proxy(builtInRange,this)(parseGlobalFloat(n),t,i)},$.validator.addMethod("mustnotcontain",function(n,t,i){var r=findInputElement(t,i.other).unbind(".validate-mustnotcontain").bind("blur.validate-mustnotcontain",function(){$(t).valid()}),u,f;return!r.val()||!n?!0:(u=r.val().toLowerCase(),f=n.toLowerCase(),!(f.indexOf(u)>-1))}),$.validator.unobtrusive.adapters.add("mustnotcontain",["other"],function(n){n.messages.mustnotcontain=n.message,n.rules.mustnotcontain=n.params}),$.validator.addMethod("postalcodeincountry",function(n,t,i){var u=findInputElement(t,i.country).unbind(".validate-postalcodeincountry").bind("blur.validate-postalcodeincountry",function(){$(t).valid()}),r,f;return!u.val()||!n?!0:(r=g_zipRegExArray[u.val()],r==undefined)?!0:(f=RegExp(r),f.exec($.trim(n))!=null)}),$.validator.unobtrusive.adapters.add("postalcodeincountry",["country"],function(n){n.messages.postalcodeincountry=n.message,n.rules.postalcodeincountry=n.params}),$.validator.addMethod("phoneincountry",function(n,t,i){var r,u,f,e;if(!n)return!0;if(r=i.country,!i.country&&i.countryproperty!=null){if(u=findInputElement(t,i.countryproperty).unbind(".validate-phoneincountry").bind("blur.validate-phoneincountry",function(){$(t).valid()}),!u.val())return!0;r=u.val()}return(f=g_phoneRegExArray[r],f==undefined)?!0:(e=RegExp(f),e.exec($.trim(n))!=null)}),$.validator.unobtrusive.adapters.add("phoneincountry",["country","countryproperty"],function(n){n.messages.phoneincountry=n.message,n.rules.phoneincountry=n.params}),$.validator.addMethod("yearordate",function(n,t,i){if(!n||n==i.allowed)return!0;var r=parseDateOrYear(n);return r!=null}),$.validator.unobtrusive.adapters.add("yearordate",["allowed"],function(n){n.messages.yearordate=n.message,n.rules.yearordate=n.params}),$.validator.addMethod("yearrange",function(n,t,i){if(!n||!i.minyear||!i.maxyear||n==i.allowed)return!0;var r=parseDateOrYear(n),u=new Date(i.minyear,0,1),f=new Date(i.maxyear,11,31);return r!=null&&r>=u&&r<=f}),$.validator.unobtrusive.adapters.add("yearrange",["minyear","maxyear","allowed"],function(n){n.messages.yearrange=n.message,n.rules.yearrange=n.params}),$.validator.addMethod("daterequired",function(n,t,i){var r;if(!i.day||!i.month||!i.year)return!1;var o=$("select[name='"+i.day+"']"),s=$("select[name='"+i.month+"']"),h=$("select[name='"+i.year+"']");if(!o.length||!s.length||!h.length)return!1;var u=o.val(),f=s.val(),e=h.val();return!u||!f||!e?!1:(r=new Date(e,f-1,u),""+e+f+u==""+r.getFullYear()+(r.getMonth()+1)+r.getDate())}),$.validator.unobtrusive.adapters.add("daterequired",["day","month","year"],function(n){n.messages.daterequired=n.message,n.rules.daterequired=n.params}),builtInDate=$.validator.methods.date,$.validator.addMethod("date",function(n,t,i){var u="#"+i.allowapproximateproperty,r=$(u),f=r.length>0?r.val()=="True":!1;return n==i.allowed||f?!0:$.proxy(builtInDate,this)(n,t)}),$.validator.unobtrusive.adapters.add("date",["allowed","allowapproximateproperty"],function(n){n.messages.date=n.message,n.rules.date=n.params}),$.validator.addMethod("requiredif",function(n,t,i){var u=$.proxy($.validator.methods.required,this),r=findInputElement(t,i.other),f=r.length>0?r.val()!=="False"&&u(r.val(),r[0]):i.required!=="False";return f?u(n,t):!0}),$.validator.unobtrusive.adapters.add("requiredif",["required","other"],function(n){n.messages.requiredif=n.message,n.rules.requiredif=n.params}),$.validator.addMethod("requiredifany",function(n,t,i){var o=$.proxy($.validator.methods.required,this),s=!1,f,u,e,r;if(i.nonemptylist&&i.nonemptylist.length>0)for(f=i.nonemptylist.split(","),u=0;u<f.length;u++)if(e=$.trim(f[u]),r=findInputElement(t,e),r.unbind(".validate-requiredifany").bind("blur.validate-requiredifany",function(){$(t).valid()}),r.length&&o(r.val(),r[0])){s=!0;break}if(i.emptylist&&i.emptylist.length>0)for(f=i.emptylist.split(","),u=0;u<f.length;u++)if(e=$.trim(f[u]),r=findInputElement(t,e),r.unbind(".validate-requiredifany").bind("blur.validate-requiredifany",function(){$(t).valid()}),!r.length||!o(r.val(),r[0])){s=!0;break}return s?o(n,t):!0}),$.validator.unobtrusive.adapters.add("requiredifany",["nonemptylist","emptylist"],function(n){n.messages.requiredifany=n.message,n.rules.requiredifany=n.params}),$.validator.addMethod("requiredifall",function(n,t,i){var o=$.proxy($.validator.methods.required,this),s=!1,f,u,e,r;if(i.nonemptylist&&i.nonemptylist.length>0)for(f=i.nonemptylist.split(","),u=0;u<f.length;u++)if(e=$.trim(f[u]),r=findInputElement(t,e),r.unbind(".validate-requiredifall").bind("blur.validate-requiredifall",function(){$(t).valid()}),r.length&&o(r.val(),r[0]))s=!0;else return!0;if(i.emptylist&&i.emptylist.length>0)for(f=i.emptylist.split(","),u=0;u<f.length;u++){if(e=$.trim(f[u]),r=findInputElement(t,e),r.unbind(".validate-requiredifall").bind("blur.validate-requiredifall",function(){$(t).valid()}),r.length&&o(r.val(),r[0]))return!0;s=!0}return s?o(n,t):!0}),$.validator.unobtrusive.adapters.add("requiredifall",["nonemptylist","emptylist"],function(n){n.messages.requiredifall=n.message,n.rules.requiredifall=n.params}),$.validator.addMethod("notequalto",function(n,t,i){var r=$(i).unbind(".validate-notequalto").bind("blur.validate-notequalto",function(){$(t).valid()});return n!=r.val()}),$.validator.addMethod("labtestresultvaluerequired",function(n,t,i){var u=!0,r,f;if(!n)return u;if(r=$(t).attr("name"),f=i.collectionproperty,r.indexOf(".")>0){var e=r.substring(0,r.lastIndexOf(".")),o=e+"."+f,s=$(":input[name^='"+o+"[']"),h=$(":input[name='"+e+".Value']");s.each(function(n,t){if($(t).val().trim().length>0&&h.val().trim().length===0)return u=!1,!1})}return u}),$.validator.unobtrusive.adapters.add("labtestresultvaluerequired",["collectionproperty"],function(n){n.messages.labtestresultvaluerequired=n.message,n.rules.labtestresultvaluerequired=n.params}),$.validator.setDefaults({onkeyup:!1});function setValidationErrorPlacement(){$("form").each(function(){var n=$.data(this,"validator").settings;n&&(n.errorPlacement=$.proxy(customUnobtrusiveOnError,this),n.success=$.proxy(customUnobtrusiveOnSuccess,this))})}function customUnobtrusiveOnError(n,t){var i=$(this).find("[data-valmsg-for='"+t[0].name+"']"),r=$.parseJSON(i.attr("data-valmsg-replace"))!==!1;n.data("unobtrusiveContainer",i),setTimeout(function(){i.removeClass("field-validation-valid").addClass("field-validation-error"),r?(i.empty(),n.removeClass("input-validation-error").appendTo(i)):n.hide()},200)}function customUnobtrusiveOnSuccess(n){var t=n.data("unobtrusiveContainer");t&&(replace=$.parseJSON(t.attr("data-valmsg-replace")),n.removeData("unobtrusiveContainer"),setTimeout(function(){t.addClass("field-validation-valid").removeClass("field-validation-error"),replace&&t.empty()},200))}$(document).ready(setValidationErrorPlacement),$.validator.unobtrusive.parseDynamicContent=function(n){$.validator.unobtrusive.parse(n);var t=$(n).closest("form");t.length||(t=$(n).find("form")),t.each(function(){var n=t.data("unobtrusiveValidation"),i=t.validate();$.each(n.options.rules,function(t,r){var u=$("[name='"+t+"']");u.length!==0&&(i.settings.rules[t]&&u.rules("remove"),r.messages=n.options.messages[t],u.rules("add",r))})}),setValidationErrorPlacement()},$.fn.revalidate=function(){if(this.length)return $.validator.unobtrusive.parseDynamicContent(this[0]),this},$.fn.clearErrors=function(){this.length&&($(this).find(".field-validation-error").removeClass("field-validation-error").addClass("field-validation-valid").empty(),$(this).find(".input-validation-error").removeClass("input-validation-error"))}}function createPageOverlay(n){var t={};return t.baseElement=$("#shellPageOverlay"),$.extend(t,n),t.show=function(){showPageOverlay(t)},t.hide=function(){hidePageOverlay(t)},t.zIndex=function(n){zIndexPageOverlay(n)},initPageOverlay(t),t}function initPageOverlay(n){n.baseElement.html()==null&&(n.baseElement=$('<div id="shellPageOverlay" class="pageOverlay"><\/div>').appendTo($("body")))}function showPageOverlay(n){n.baseElement.fadeIn("fast")}function hidePageOverlay(n){n.baseElement.hide()}function zIndexPageOverlay(n){var t=$("#shellPageOverlay");t.css("z-index",n)}typeof hv=="undefined"&&(hv={}),hv.directoryCarousel={},hv.directoryCarousel.step=4,hv.directoryCarousel.itemWidth=170;var DirectoryCarousel=Class.create({current:0,leftBound:!1,rightBound:!1,busy:!1,init:function(n){this.elem=n,this.max=+n.attr("itemCount"),this.leftLink=n.find("a.slideLeft"),this.leftImg=this.leftLink.children("img"),this.rightLink=n.find("a.slideRight"),this.rightImg=this.rightLink.children("img"),this.initPosition(),this.toggle()},initPosition:function(){var n=this;this.elem.find(".directoryCarouselContent .directoryItem").each(function(t){0<=t&&t<hv.directoryCarousel.step?n.showItem($(this),t):$(this).hide()})},toggle:function(){this.current==0?(this.leftLink.unbind("click").attr("disabled","disabled").css("cursor","default"),this.leftImg.attr("src",g_imagePath+"/icons/slide-left2-disabled.png"),this.leftBound=!1):this.current==0||this.leftBound||(this.attachLeft(),this.leftLink.removeAttr("disabled").css("cursor",""),this.leftImg.attr("src",g_imagePath+"/icons/slide-left2.png"),this.leftBound=!0),this.current+hv.directoryCarousel.step>=this.max?(this.rightLink.unbind("click").attr("disabled","true").css("cursor","default"),this.rightImg.attr("src",g_imagePath+"/icons/slide-right2-disabled.png"),this.rightBound=!1):this.current+hv.directoryCarousel.step<this.max&&!this.rightBound&&(this.attachRight(),this.rightLink.removeAttr("disabled").css("cursor",""),this.rightImg.attr("src",g_imagePath+"/icons/slide-right2.png"),this.rightBound=!0)},showItem:function(n,t){n.data("initialized")||(n.data("initialized",1),n.css({top:"0px",left:hv.directoryCarousel.itemWidth*t+"px"}),n.find(".logoContainer").loadAppImageLogo(),n.directoryItemTooltip()),n.show()},showNewPageItems:function(n){var i=this,t=n>=0?this.current+hv.directoryCarousel.step-n:this.current,r=t+Math.abs(n);this.elem.find(".directoryCarouselContent .directoryItem").each(function(n){t<=n&&n<r&&i.showItem($(this),n)})},hideOldPageItems:function(n){var t=n>=0?this.current-n:this.current+hv.directoryCarousel.step,i=t+Math.abs(n);this.elem.find(".directoryCarouselContent .directoryItem").filter(function(n){return t<=n&&n<i}).hide()},updateCurrent:function(n){var i,t;this.busy||(this.busy=!0,i=n-this.current,this.current=n,this.showNewPageItems(i),t=this,this.elem.find(".directoryCarouselContent").animate({left:-(hv.directoryCarousel.itemWidth*this.current)},200,null,function(){t.hideOldPageItems(i),t.toggle(),t.busy=!1}))},attachLeft:function(){var n=this;this.leftLink.click(function(){n.updateCurrent(Math.max(n.current-hv.directoryCarousel.step,0))})},attachRight:function(){var n=this;this.rightLink.click(function(){n.updateCurrent(Math.min(n.current+hv.directoryCarousel.step,n.max-hv.directoryCarousel.step))})}});(function(n){n.fn.directoryCarousel=function(){return this.each(function(){n(this).data("carousel",new DirectoryCarousel(n(this)))}),this}})(jQuery);(function(n){var t=null;n.fn.dropdown=function(r,u){function c(n){(n.source.click(function(i){i.stopPropagation();var r=n.visible;t&&(t.hideFast(),t=null),r||(a(n),n.showContent(n.source),s(n),t=e)}),n.container.addClass("hv-dropdown-top"),n.container.is(":visible"))&&o(n)}function o(t){t.content.hide().addClass("hv-dropdown-content").css(t.opensUp?"bottom":"top",t.container.innerHeight()).css("min-width",t.container.innerWidth()).css(t.align,t.offset-1).css("background-color",t.background).appendTo(t.container),t.hider=n("<div class='hv-dropdown-hider hide'>&nbsp;<\/div>").css(t.opensUp?"bottom":"top",t.container.innerHeight()).css("width",t.container.innerWidth()).css("background-color",t.background).appendTo(t.container),t.initialized=!0}function s(n){n.initialized||o(n),n.container.addClass("open"),n.hider.show(),n.content.slideDown(),n.visible=!0}function h(n){n.content.slideUp("fast",function(){n.container.removeClass("open"),n.hider.hide()}),n.visible=!1}function l(n){n.content.hide(),n.container.removeClass("open"),n.hider.hide(),n.visible=!1}function a(r){var u=function(f){var e=n(f.target);if(!r.container.has(e).length){for(i in r.focusExceptions)if(e.is(r.focusExceptions[i])||n(r.focusExceptions[i]).has(e).length)return;h(r),n(document).unbind("focusin",u),n(document).unbind("click",u),t=null}};n(document).focusin(u),n(document).click(u)}var f,e;return!this||!this.length?this:(e=this.first().data("hv-dropdown"),e)?e:(f={source:this.first(),content:n(r),container:this.parent(),align:"right",opensUp:!1,offset:0,background:"#fff",visible:!1,focusExceptions:["#ui-datepicker-div"],initialized:!1,showContent:function(){}},f=n.extend(f,u),c(f),e={show:function(){s(f)},hide:function(){h(f)},hideFast:function(){l(f)},text:function(t,i){i?n(i).text(t):f.source.text(t),f.hider.css("width",f.container.innerWidth()),f.content.css("min-width",f.container.innerWidth())}},this.first().data("hv-dropdown",e),e)}})(jQuery);(function(n){function h(i){var f=100,u;i.topArrow=n('<div class="topArrow"><\/div>'),i.bottomArrow=n('<div class="bottomArrow"><\/div>'),i.leftArrow=n('<div class="leftArrow"><\/div>'),i.rightArrow=n('<div class="rightArrow"><\/div>'),i.baseElement.append(i.topArrow),i.baseElement.append(i.bottomArrow),i.baseElement.append(i.leftArrow),i.baseElement.append(i.rightArrow),i.source.css("position","relative"),i.content.width(i.width-f),i.content.appendTo(n("body")),i.baseElement.append(i.content),i.content.css({display:"block",visibility:"visible"}),i.baseElement.appendTo(n("body")),u=i.source.get(0).nodeName.toLowerCase(),u=="input"&&i.source.keydown(function(n){i.enterEvent=n,n.keyCode!=9&&(i.visible||r(i))}),(u=="a"||u=="span")&&(i.source.keydown(function(n){n.keyCode==13&&(n.preventDefault(),i.visible?t(i):r(i))}),i.trigger=="click"?i.source.click(function(){r(i),i.baseElement.hover(function(){},function(){t(i)})}):(i.source.hover(function(n){i.enterEvent=n,i.timer=setTimeout(function(){r(i)},i.delay)},function(){c(i)}),i.baseElement.hover(function(){clearTimeout(i.timer)},function(){t(i)})))}function c(n){clearTimeout(n.timer),n.timer=setTimeout(function(){t(n)},50)}function t(n){n.visible&&(n.baseElement.css("display","none"),o(n),n.visible=!1,clearTimeout(n.timer))}function r(n){n.visible||(n.sourcePosition=n.source.offset(),n.baseElement.css("display","block"),o(n),n.baseElement.focusFirst(),n.visible=!0,l(n))}function o(n){switch(n.position){case"left":u(n);break;case"right":u(n);break;case"top":e(n);break;case"bottom":e(n);break;case"none":e(n);break;case"auto-h":u(n);break;default:u(n)}var i=parseInt(n.baseElement.css("top"))+n.offset.top,t=parseInt(n.baseElement.css("left"));(!f||n.forceOffset)&&(t+=n.offset.left),n.baseElement.css("top",i),n.baseElement.css("left",t)}function e(t){var r=t.position,i=0,u=t.enterEvent.pageX-60;t.sourcePosition.top<t.content.outerHeight(!0)+global.window.scrollTop()?(r="bottom",i=t.sourcePosition.top+30):t.sourcePosition.top+t.content.outerHeight(!0)>n(window).height()+global.window.scrollTop()?(r="top",i=t.sourcePosition.top-t.baseElement.outerHeight(!0)):i=r=="bottom"?t.sourcePosition.top+15:t.sourcePosition.top-t.baseElement.outerHeight(!0),s(r,t),t.baseElement.css("top",i),t.baseElement.css("left",u)}function u(t){var i=t.position,u=t.sourcePosition.top-30,r=0;t.sourcePosition.left<t.content.outerWidth(!0)+global.window.scrollLeft()?(i="right",r=t.sourcePosition.left+t.source.outerWidth(!0)+30,f=!0):t.sourcePosition.left+t.content.outerWidth(!0)>n(window).width()+global.window.scrollLeft()?(i="left",r=t.sourcePosition.left-t.width-30,f=!0):(i=="auto-h"&&t.autoReference.length&&(i=t.sourcePosition.left+t.source.outerWidth(!0)/2<t.autoReference.offset().left+t.autoReference.width()/2?"right":"left"),r=i=="right"?t.sourcePosition.left+t.source.outerWidth(!0)+30:t.sourcePosition.left-t.width-30),s(i,t),t.baseElement.css("top",u),t.baseElement.css("left",r)}function s(n,t){t.leftArrow.hide(),t.rightArrow.hide(),t.topArrow.hide(),t.bottomArrow.hide();switch(n){case"left":t.rightArrow.show();break;case"right":t.leftArrow.show();break;case"top":t.bottomArrow.show();break;case"bottom":t.topArrow.show();break;default:t.rightArrow.show()}}function l(r){var u=function(f){var e=n(f.target);if(e.get(0)!=r.source.get(0)&&!r.source.has(e).length&&!r.baseElement.has(e).length){for(i in r.focusExceptions)if(e.is(r.focusExceptions[i])||n(r.focusExceptions[i]).has(e).length)return;t(r),n(document).unbind("focusin",u),n(document).unbind("click",u)}};n(document).focusin(u),n(document).click(u)}var f=!1;n.fn.tip=function(t){return this.each(function(){var i={source:n(this),sourcePosition:0,offset:{top:0,left:0},forceOffset:!1,autoReference:n(this).closest(".tipAutoReference"),baseElement:n('<div class="tip"><\/div>'),content:null,position:"left",topArrow:null,bottomArrow:null,leftArrow:null,rightArrow:null,visible:!1,width:200,timer:null,enterEvent:null,delay:0,trigger:"hover",focusExceptions:["#ui-datepicker-div"]};i=n.extend(i,t),h(i)}),this}})(jQuery);(function(n){n.fn.enable=function(){if(this&&this.length)return this.each(function(t,i){i=n(i),i.is("a.button[data-disabled-href]")?(i.attr("href",i.attr("data-disabled-href")),i.removeAttr("data-disabled-href")):i.is("input[type='button'][disabled], input[type='submit'][disabled]")&&i.removeAttr("disabled")}),this},n.fn.disable=function(){if(this&&this.length)return this.each(function(t,i){i=n(i),i.is("a.button[href]")?(i.attr("data-disabled-href",i.attr("href")),i.removeAttr("href")):i.is("input[type='button'], input[type='submit']")&&i.attr("disabled","disabled")}),this},n.fn.toggleEnabled=function(){if(this&&this.length)return this.each(function(t,i){i=n(i),i.is("a.button[data-disabled-href], input[disabled]")?i.enable():i.disable()}),this}})(jQuery);function createLightbox(n){var t={};return t.height=0,t.width=global.dialogWidth,t.className=null,t.content=null,t.footer=null,t.header=null,t.toolbar=null,t.baseElement=$('<div class="lightbox"><\/div>'),t.iFrameUrl=null,t.iFrameDoc=null,t.top=0,t.opened=function(){},t.closed=function(){},t.closeText=g_closeText,t.detachContentOnCloseAspx=!1,t.deleteContentOnClose=!0,t.show=function(n){var i=$(n);if($(document).off("closeLightBoxEvent",setFocusOnElement),i.length>0)$(document).on("closeLightBoxEvent",{element:i},setFocusOnElement);showLightbox(t)},t.hide=function(){hideLightbox(t)},t.resize=function(){setLightboxSize()},t.focusToolbar=!1,t.navigate=function(n){lightboxNavigate(n)},$.extend(t,n),initializeLightBox(t),t}function initializeLightBox(n){lightboxes==null&&(lightboxes=lightboxManager()),n.className!=null&&n.baseElement.addClass(n.className)}function showLightbox(n){global.topMostZindex+=2,setContent(n),lightboxes.items.push(n),openLightBoxEvent(),n.iFrameUrl!=null?(n.content.load(function(){try{n.iFrameDoc=n.content.contents().find("body")}catch(t){n.content.attr("src",n.content.attr("src"));return}n.baseElement.css("z-index",global.topMostZindex),n.baseElement.fadeIn("fast",function(){n.focusToolbar?n.baseElement.focusFirst():n.iFrameDoc.focusFirst()}),setLightboxSize(),setLightboxPosition(),n.iFrameDoc.keydown(function(n){n.keyCode==27&&closeLightBoxHandler()})}),n.content.attr("src",n.iFrameUrl)):(n.baseElement.css("z-index",global.topMostZindex),n.baseElement.fadeIn("fast",function(){n.focusToolbar?n.baseElement.focusFirst():n.content.focusFirst()}),setLightboxSize(),setLightboxPosition()),n.baseElement.bind("keydown",function(t){t.keyCode==27&&hideLightbox(n)}),n.baseElement.keepFocus(),lightboxes.pageOverlay.zIndex(global.topMostZindex-1),lightboxes.pageOverlay.show()}function hideLightbox(n,t){if(closeLightBoxEvent(t),n==null&&(n=lightboxes.topMost()),n!=null){if(lightboxes.items.pop(),n.baseElement.unbind("keydown"),global.topMostZindex-=2,n.deleteContentOnClose&&removeContent(n),n.baseElement.fadeOut("fast"),lightboxes.items.length<1)lightboxes.pageOverlay.hide();else{lightboxes.pageOverlay.zIndex(global.topMostZindex-1);var i=lightboxes.topMost();scrollToNextLightbox(),$(i.baseElement).focus()}n.baseElement.unbind("click"),n.baseElement.releaseFocus()}lightboxes.pageOverlay.baseElement.unbind("click")}function scrollToNextLightbox(){lightboxes.items.length>0&&$(window).scrollTop(lightboxes.topMost().top)}function removeContent(n){var t=$("form[name|='aspnetForm']");n.iFrameUrl!=null?(n.content.attr("src",""),n.content.remove()):t.length?n.detachContentOnCloseAspx?n.content.detach():n.content.hide().appendTo(t):n.content.detach(),$(n.header).detach(),$(n.footer).detach(),$(n.toolbar).detach(),n.baseElement.clear()}function setContent(n){var t,i,r;n.toolbar==null&&(n.toolbar=$("<div class='toolbar'><\/div>"),t=$("<a id='closeX' href='javascript:void(0);' class='default close'><\/a>"),t.attr("title",n.closeText),t.appendTo(n.toolbar),i=$("<img><\/img>").appendTo(t),i.attr("alt",n.closeText),i.attr("src",g_imagePath+"/icons/X-lightbox.gif"),n.toolbar.bind("click",function(){hideLightbox(n)})),typeof n.content=="string"&&(n.content.indexOf("http://")!=-1||n.content.indexOf("https://")!=-1)&&(n.iFrameUrl=n.content,n.content=$('<iframe id="lightboxFrame" scrolling="no" frameborder="0"><\/iframe>')),n.baseElement.appendTo(lightboxes.pageOverlay.baseElement),n.toolbar&&n.toolbar.appendTo(n.baseElement).show(),n.header&&(typeof n.header=="string"&&(n.headerClassName==null?n.header=$("<div class='h2'><\/div>").html(n.header):(r="<div class='"+n.headerClassName+"'><\/div>",n.header=$(r).html(n.header))),n.header.appendTo(n.baseElement).show()),n.content&&n.content.appendTo(n.baseElement).show(),n.footer&&n.footer.appendTo(n.baseElement).show()}function setLightboxPosition(){var r,n,t,i;if(lightboxes.items.length>0)for(r=lightboxes.startTop,n=0;n<lightboxes.items.length;n++)t=lightboxes.items[n],i=global.window.width()/2-t.width/2+global.window.scrollLeft()-lightboxes.offset,i<0&&(i=0),r+=global.window.scrollTop(),t.baseElement.css("left",i+n*lightboxes.offset),t.top=r+n*lightboxes.offset,t.baseElement.css("top",t.top)}function setLightboxSize(){var n=lightboxes.topMost();n!=null&&(n.iFrameDoc!=null?(n.width==0&&(n.width=n.iFrameDoc.outerWidth()),n.height=n.iFrameDoc.outerHeight(!0)+n.content.contents().scrollTop()):n.width==0&&(n.width=n.content.innerWidth()),n.height!=0&&n.content.height(n.height),n.width!=0&&n.content.width(n.width))}function navigateLightboxHandler(n){parent.$(parent.document).trigger("navigateLightbox",n)}function resizeLightBoxHandler(){try{parent.$(parent.document).trigger("resizeLightbox")}catch(n){}}function closeLightBoxHandler(n){parent.$(parent.document).trigger("closeLightBox",[n])}function openLightBoxEvent(){parent.$(parent.document).trigger("openLightBoxEvent")}function closeLightBoxEvent(n){parent.$(parent.document).trigger("closeLightBoxEvent",[n])}function setFocusOnElement(n){setTimeout(function(){n.data.element.focus()},0)}var lightboxes=null,lightboxManager=function(){var n={};n.items=[],n.offset=30,n.startTop=100,n.pageOverlay=createPageOverlay(),n.topMost=function(){return n.items.length>0?n.items[n.items.length-1]:null},n.lightboxOpened=function(t,i){var r=n.topMost();r!=null&&r.opened(i)},n.lightboxClosed=function(t,i){var r=n.topMost();r!=null&&r.closed(i)};$(document).on("resizeLightbox",function(){var t=n.topMost();t!=null&&setLightboxSize()});$(document).on("navigateLightbox",function(t){var i=n.topMost();i.content.attr("src",t)});$(document).on("closeLightBoxEvent",n.lightboxClosed);$(document).on("openLightBoxEvent",n.lightboxOpened);$(document).on("closeLightBox",function(n,t){hideLightbox(null,t)});$(window).on("resize",function(){setLightboxPosition()});return n};function createEditorbox(n){var t={};return t.className=null,t.content=null,t.toolbar=null,t.baseElement=$('<div class="editorbox"><\/div>'),t.opened=function(){},t.closed=function(){},t.closeText=g_closeText,t.deleteContentOnClose=!0,t.showEditor=function(){showEditorbox(t)},t.hide=function(){hideEditorbox(t)},t.focusToolbar=!1,$.extend(t,n),initializeEditorBox(t),t}function initializeEditorBox(n){editorboxes==null&&(editorboxes=editorboxManager()),n.className!=null&&n.baseElement.addClass(n.className)}function showEditorbox(n){setEditorContent(n),editorboxes.items.push(n),openEditorBoxEvent(n.baseElement);var t=n.baseElement.find("#editorContents");n.baseElement.fadeIn("fast",function(){t.focusFirst()})}function hideEditorbox(n,t){closeEditorBoxEvent(t),n==null&&(n=editorboxes.topMost()),n!=null&&(editorboxes.items.pop(),n.baseElement.unbind("keydown"),n.deleteContentOnClose&&removeEditorContent(n),n.baseElement.fadeOut("fast"),n.baseElement.unbind("click"))}function removeEditorContent(n){n.content.detach(),$(n.header).detach(),$(n.footer).detach(),$(n.toolbar).unbind("click").detach(),n.baseElement.clear()}function setEditorContent(n){var t,i;n.toolbar==null&&(n.toolbar=$("<div class='toolbar right'><\/div>"),t=$("<a id='closeX' href='javascript:void(0);' class='default close'><\/a>"),t.attr("title",n.closeText),t.appendTo(n.toolbar),i=$("<img><\/img>").appendTo(t),i.attr("alt",n.closeText),i.attr("src",g_imagePath+"/icons/icon_Close.png")),n.toolbar&&(n.toolbar.appendTo(n.baseElement).show(),n.toolbar.bind("click",function(){hideEditorbox(n,hv.editor.addAnother)})),n.content&&n.content.appendTo(n.baseElement).show()}function closeEditorBoxHandler(n){parent.$(parent.document).trigger("closeEditorBox",[n])}function openEditorBoxEvent(n){parent.$(parent.document).trigger("openEditorBoxEvent",[n])}function closeEditorBoxEvent(n){parent.$(parent.document).trigger("closeEditorBoxEvent",[n])}var editorboxes=null,editorboxManager=function(){var n={};n.items=[],n.topMost=function(){return n.items.length>0?n.items[n.items.length-1]:null},n.editorboxOpened=function(t,i){var r=n.topMost();r!=null&&r.opened(i)},n.editorboxClosed=function(t,i){var r=n.topMost();r!=null&&r.closed(i)};$(document).on("closeEditorBoxEvent",n.editorboxClosed);$(document).on("openEditorBoxEvent",n.editorboxOpened);$(document).on("closeEditorBox",function(n,t){hideEditorbox(null,t)});return n};(function(n){function i(i){i.picker.parent().height(i.picker.outerHeight(!0)),i.link.click({settings:i},function(n){var i=n.data.settings;return i.menu.is(":visible")?t(i):r(i),!1}),n("#recordMenu,.recordPerson").focusout({settings:i},function(i){var r=function(){var r=!0;n("#recordMenu").find("a").each(function(){this==document.activeElement&&(r=!1)}),r&&t(i.data.settings)};setTimeout(r,10)})}function r(n){n.records.removeAttr("tabIndex"),n.arrowImg.attr("src",n.arrowUp),n.menu.slideDown(global.animationSpeed)}function t(n){n.records.attr("tabIndex","-1"),n.arrowImg.attr("src",n.arrowDown),n.menu.slideUp(global.animationSpeed)}n.fn.recordPicker=function(t){return this.each(function(){var r={picker:n(this),link:n(".recordPerson"),menu:n("#recordMenu"),arrowImg:n("#recordSwitcherArrow"),arrowDown:g_imagePath+"/icons/icon_recordPicker_downArrow.png",arrowUp:g_imagePath+"/icons/icon_recordPicker_upArrow.png",records:n("#recordItems").find("a")};n.extend(r,t),i(r)}),this}})(jQuery);function updateUnitsLabels(n){$(".variableLabel").each(function(t,i){var r=$(i),u=r.parent().parent().find(n).find("input[type=text]").first().attr("id");r.attr("for",u)})}typeof hv=="undefined"&&(hv={}),function(n){hv.editor={editUrl:"",newUrl:"",editorboxes:[],launch:function(t,i){var u,r,f;if(editorboxes!=null&&(u=editorboxes.topMost(),u!=null&&(editorboxes.items.pop(),u.baseElement.unbind("keydown"),removeEditorContent(u),u.baseElement.fadeOut("fast"),u.baseElement.unbind("click"))),r=hv.editor.editorboxes[t],r||(r=createEditorbox({content:n("<div id='hv-editor-content' class='hide'><\/div>").appendTo(document.body),width:0,detachContentOnCloseAspx:!0}),hv.editor.editorboxes[t]=r),r.opened=function(r){n(document).trigger("editorOpened",[r,t,i])},r.closed=function(r){n(document).trigger("editorClosed",[r,t,i])},i&&t)f=hv.editor.editUrl+"?thingId="+i+"&typeId="+t;else if(t)f=hv.editor.newUrl+"?typeId="+t;else return;hv.loadingOverlay.show(),r.content.hide().appendTo(document.body),n.get(f,null,function(n){r.content.html(n),hv.loadingOverlay.hide(),r.showEditor()})},initialize:function(){var t=n("#hv-editor-content");t.find("[data-editor-template]").click(function(){var i=n(this).data("editor-template"),r=t.find("[data-editor-repeater]").has("[name^='"+i+"']"),f=r.first();if(f.length!=0){var u=f.clone(),e=i.replace(/\./g,"_"),o=i.replace(/\./g,"\\."),s=new RegExp(o+"\\[0\\]","g"),h=new RegExp(e+"_0_","g");u.html(u.html().replace(s,i+"["+r.length+"]").replace(h,e+"_"+r.length+"_")),u.find(":input").clear(),r.last().after(u)}}),n(".hv-editor-temporary").each(function(){var t=n(this);setTimeout(function(){t.fadeOut()},5e3)})},parse:function(t){t||(t=n(document)),n("[data-editor]",t).click(function(t){t.stopPropagation();var i=n(this).data("editor"),r=n(this).data("editor-thing");hashManager.load(),typeof r=="undefined"?hashManager.setKey("edit",i):hashManager.setKey("edit",i+"/"+r)})},allowOnlyNumber:function(t){if(t.charCode==46||t.charCode==44){var i=n(t.target).val();return!(i.indexOf(",")!==-1||i.indexOf(".")!==-1)}return t.charCode>=48&&t.charCode<=57||t.charCode===0}},n.fn.clear=function(){this.filter(":input").each(function(){switch(this.type){case"checkbox":case"radio":n(this).removeAttr("checked");break;case"hidden":break;default:n(this).val("")}})},n.fn.editorOpened=function(t){n(this).on("editorOpened",t)},n.fn.editorClosed=function(t){n(this).on("editorClosed",t)},n.fn.showHideFormSection=function(t){if(this&&this.length){var r=n("#TypeId").val(),i=n("#editorContents").has("input[Value="+r+"]");return this.each(function(r,u){var e,s;u=n(u);var o=u.attr("id")||u.attr("class"),h=o.split(" "),c=h.length,f=t[o]?"#"+o:null;if(!f)for(e=0;e<c;e++)if(s=h[e],t[s]){f="."+s;break}i.undelegate(f,"click"),i.delegate(f,"click",{key:f,toggleSections:t},function(t){for(var i=n(t.target),u=t.data.toggleSections,o=t.data.key.toString(),f=o.slice(1,o.length),s=u[f].showHideKey,r=n(s,i.parent()),e=i.parent();!r.length;)e=e.parent(),r=n(s,e);n(r).first().is(":visible")?i.html(u[f].showMessage):i.html(u[f].hideMessage),i.toggleClass("hv-editor-expandlink-open"),i.toggleClass("expanded"),n(r).first().slideToggle(),setTimeout(function(){n("[watermark]").watermark()},500)})}),this}},n(document).ready(function(){hv.editor.parse()})}(jQuery);if(typeof hv=="undefined"&&(hv={}),!hv.viewItemGrid){hv.viewItemGrid={init:function(n){n||(n=document),$("#selectAll",n).click(function(n){var t=n.target.checked,i;$(this).attr("checked",t),i=$(this).closest("table"),$("tr.itemrow",i).toggleClass("selected",!1).toggleClass("checked",t),$("td input:checkbox",i).attr("checked",t).toggleClass("hide",!t)}),$(".itemrow",n).each(function(){var n=$(this),t=$(this).closest("table");n.mouseover(function(){$("td input:checkbox",n).is("[checked]")||n.hasClass("selected")||(n.addClass("hover"),$("td input:checkbox",n).removeClass("hide"))}),n.mouseout(function(){$("td input:checkbox",n).is("[checked]")||n.hasClass("selected")||(n.removeClass("hover"),$("td input:checkbox",n).addClass("hide"))}),n.click(function(){var f=$(".actionsContent"),i,r,u;f.is(":visible")==!1&&(n.hasClass("selected")?($(".actionsIcon",n).addClass("actionsImage").removeClass("actionsImageSelected"),$(".personalIcon",n).addClass("personalImage").removeClass("personalImageSelected"),$(".signatureIcon",n).addClass("signatureImage").removeClass("signatureImageSelected"),$(".itemrow",t).removeClass("hover").removeClass("checked").removeClass("selected"),$("td input:checkbox",t).addClass("hide")):(i=$("td input:checkbox",n).attr("checked"),$(".itemrow",t).each(function(){var n=$(this);n.removeClass("hover").removeClass("checked").removeClass("selected"),$("td input:checkbox",n).attr("checked",!1),$(".actionsIcon",n).addClass("actionsImage").removeClass("actionsImageSelected"),$(".personalIcon",n).addClass("personalImage").removeClass("personalImageSelected"),$(".signatureIcon",n).addClass("signatureImage").removeClass("signatureImageSelected")}),$("td input:checkbox",t).addClass("hide"),$("td input:checkbox",n).removeClass("hide").attr("checked",i),n.addClass("selected"),$(".actionsIcon",n).removeClass("actionsImage").addClass("actionsImageSelected"),$(".personalIcon",n).removeClass("personalImage").addClass("personalImageSelected"),$(".signatureIcon",n).removeClass("signatureImage").addClass("signatureImageSelected"),r=n.data("type-id"),u=n.data("thing-id"),hashManager.load(),hashManager.setKey("id",r+"/"+u)))})}),$(".itemrow td input:checkbox",n).each(function(){$(this).click(function(n){var i,t;n.stopPropagation(),i=n.target.checked,!i&&$("#selectAll").is("[checked]")&&$("#selectAll").removeAttr("checked"),$(this).attr("checked",i).toggleClass("hide",!i),t=$(this).parent().parent(),t.toggleClass("checked",i),t.hasClass("selected")&&t.removeClass("selected"),t.hasClass("checked")?($(".actionsIcon",t).removeClass("actionsImage").addClass("actionsImageSelected"),$(".personalIcon",t).removeClass("personalImage").addClass("personalImageSelected"),$(".signatureIcon",t).removeClass("signatureImage").addClass("signatureImageSelected")):($(".actionsIcon",t).addClass("actionsImage").removeClass("actionsImageSelected"),$(".personalIcon",t).addClass("personalImage").removeClass("personalImageSelected"),$(".signatureIcon",t).addClass("signatureImage").removeClass("signatureImageSelected"))})}),$(".actionsDropDown",n).each(function(){$(this).dropdown($(this).parents("td").find(".actionsContent"),{showContent:function(n){n.closest(".viewItemGrid").siblings(".viewItemGrid").css("z-index","auto").end().css("z-index","1")}})}),$(n).editorClosed(function(){$(".actionsContent").hide()}),$(".notTakingAction",n).click(function(){$(this).parent().find(".notTakingContainer").show()}),$(".closeNotTaking",n).click(function(){$(this).parents(".notTakingContainer").hide(),$(this).parents(".actionsContainer").find(".actionsDropDown").dropdown().hide()}),$(".notTakingForm",n).submit(function(){$(this).valid()&&($(this).parents(".notTakingContainer").hide(),$(this).parents(".actionsContainer").find(".actionsDropDown").dropdown().hide())})}};var getItemDetails=function(n,t,i,r){function o(n){var i,t,r;u.html(n),c.html()==""&&(i=f.find(".details_title").html(),t=f.find(".details_value").html(),t&&t!=""||(t=$(".xslThingTitle").html()),r=i!=null?i:t,c.html(r)),e.addClass("hide"),$("#detailsContainer").outerHeight(!0)<$(document).height()&&$("#viewAsXmlDiv").addClass("absolute")}function s(n){n._message!=null&&n._message.search(/maxJsonLength/)>0?u.html(g_contentSizeMessage):u.html(g_errorMessage),e.addClass("hide")}var h=$("#detailsContainer"),f=h.find("[data-thing-id='"+r+"']"),c=f.children(".thingTitle"),u,e;if(n==null?(h.removeClass("hide"),$("#gridContainer").addClass("hide"),$(".itemDetailsContainer",h).addClass("hide"),f.removeClass("hide")):setItemActiveTab(n,t),f.children(".contentDiv").addClass("hide"),u=f.children(".genTab"+t),u){if(u.html()!=""){u.removeClass("hide"),applyEllipsis();return}e=f.find(".contentLoading"),e.removeClass("hide"),u.empty(),u.removeClass("hide");switch(t){case"SUMMARY":i=i!=""?i:r,$.ajax({url:"/ItemDetails/GetSummary",type:"POST",dataType:"json",cache:!1,async:!0,traditional:!0,data:$.extend({typeId:i,thingId:r},g_antiForgeryToken),success:function(n){o(n),resizePreviewImage($(".previewImg"))},error:function(n){s(n)}});break;case"HISTORY":$.ajax({url:"/ItemDetails/GetHistory",type:"POST",dataType:"json",cache:!1,async:!0,traditional:!0,data:$.extend({thingId:r},g_antiForgeryToken),success:function(n){o(n)},error:function(n){s(n)}});break;case"SIGNATURE":$.ajax({url:"/ItemDetails/GetSignature",type:"POST",dataType:"json",cache:!1,async:!0,traditional:!0,data:$.extend({thingId:r},g_antiForgeryToken),success:function(n){o(n)},error:function(n){s(n)}});break;case"RELATED":$.ajax({url:"/ItemDetails/GetRelated",type:"POST",dataType:"json",cache:!1,async:!0,traditional:!0,data:$.extend({thingId:r},g_antiForgeryToken),success:function(n){o(n)},error:function(n){s(n)}})}}};function setItemActiveTab(n,t){n.children(".tabDiv").addClass("viewItemsInActiveTab").removeClass("viewItemsActiveTab"),t=="SUMMARY"?n.children(".genPropertyTab").addClass("viewItemsActiveTab").removeClass("viewItemsInActiveTab"):t=="HISTORY"?n.children(".genHistoryTab").addClass("viewItemsActiveTab").removeClass("viewItemsInActiveTab"):t=="SIGNATURE"?n.children(".genSignatureTab").addClass("viewItemsActiveTab").removeClass("viewItemsInActiveTab"):t=="RELATED"&&n.children(".genRelatedTab").addClass("viewItemsActiveTab").removeClass("viewItemsInActiveTab")}$(document).ready(function(){hv.viewItemGrid.init(document)})}typeof hv=="undefined"&&(hv={}),hv.chart={},hv.chart.resources={},hv.chart.filter={last7days:1,last30days:2,last90days:3,last1yearbymonths:4,last1yearbydays:5,last6months:6};var ChartFilterHelper=Class.create({settings:{chartRoot:".chartRoot",activeElem:".chartTimeActiveFilter a",filterList:".chartTimeFilters"},init:function(n){this.elem=n,this.activeElem=n.find(this.settings.activeElem),this.filterList=n.find(this.settings.filterList),this.chartRoot=n.closest(this.settings.chartRoot),this.links=this.filterList.find("a"),this.initHover(),this.initLinkClicks()},initHover:function(){var n=this;this.activeElem.click(function(){n.showList()}),this.links.focusout(function(){n.links.last().data("filter")===$(this).data("filter")&&n.hideList()}),this.elem.hover(function(){n.showList()},function(){n.hideList()})},showList:function(){var n=this.links.not("[disabled]").first(),t=this;this.elem.animate({"border-color":"#666"},500),this.filterList.fadeIn(500,function(){$(document).one("click",function(){t.hideList()})}),setTimeout(n.focus.bind(n),0)},hideList:function(){this.elem.stop(!0,!0),this.filterList.stop(!0,!0),this.elem.css("border-color","#FFF"),this.filterList.hide()},initLinkClicks:function(){var n=this;this.links.click(function(){n.hideList(),n.activeElem.text($(this).text()),n.activeFilter($(this).data("filter")),n.links.removeAttr("disabled"),$(this).attr("disabled","disabled"),n.chartRoot.trigger("hv.chart.filterchange",n.activeFilter())})},activeFilter:function(n){return n&&this.activeElem.data("filter",n),this.activeElem.data("filter")}}),ContentLoadingHelper=Class.create({timeoutHandle:null,init:function(n,t,i,r){var u=n.closest(".chartRoot");this.chartArea=n,this.loadElem=t,this.emptyElem=i,this.errorElem=r,u.bind("hv.chart.refreshInit",{ref:this},this.onInit),u.bind("hv.chart.refreshSuccess",{ref:this},this.onSuccess),u.bind("hv.chart.refreshError",{ref:this},this.onError)},onInit:function(n){var t=n.data.ref;clearTimeout(t.timeoutHandle),t.timeoutHandle=setTimeout(function(){t.chartArea.hide(),t.emptyElem.hide(),t.errorElem.hide(),t.loadElem.show()},500)},onSuccess:function(n,t){var i=n.data.ref;clearTimeout(i.timeoutHandle),i.errorElem.hide(),i.loadElem.hide(),t.data?(i.emptyElem.hide(),i.chartArea.show()):(i.chartArea.hide(),i.emptyElem.show())},onError:function(n){var t=n.data.ref;clearTimeout(t.timeoutHandle),t.chartArea.hide(),t.loadElem.hide(),t.emptyElem.hide(),t.errorElem.show()}}),GoalSeries=Class.create({minDate:1,maxDate:9007199254740992,data:[],color:"#FFE88C",shadowSize:0,points:{show:!1},onSuccess:function(n){this.update(n)},update:function(n){n.goal?n.goal.chart?this.updateData(n.goal.min,n.goal.max):this.data=null:this.data=null}}),GoalSeriesBar=GoalSeries.extend({lines:{lineWidth:0,fill:.6,show:!0,clickable:!1,hoverable:!1},updateData:function(n,t){this.data=[[this.minDate,t,n],[this.maxDate,t,n]]}}),GoalSeriesLine=GoalSeries.extend({lines:{lineWidth:3,show:!0,clickable:!1,hoverable:!1},updateData:function(n,t){var i=n+(t-n)/2;this.data=[[this.minDate,i],[this.maxDate,i]]}}),BarSeries=Class.create({data:[],bars:{show:!0,align:"center",lineWidth:1,fill:1},getBarWidth:function(n){var t=+n,i=t==hv.chart.filter.last1yearbymonths||t==hv.chart.filter.last1yearbydays?17:.4;return 864e5*i}}),ChartXAxis=Class.create({defaults:{showAlternateMonths:!1},tickLength:5,mode:"time",position:"bottom",init:function(n){this.options=$.extend({},this.defaults,n)},onSuccess:function(n){this.update(n)},update:function(n){n.beginDate&&n.endDate&&(this.min=n.beginDate,this.max=n.endDate,this.ticks=this.getTicks(n.filterType))},getTicks:function(n){switch(+n){case hv.chart.filter.last7days:return this.ticks7days();case hv.chart.filter.last30days:return this.ticks30days();case hv.chart.filter.last90days:return this.ticks90days();case hv.chart.filter.last6months:return this.ticks6months();case hv.chart.filter.last1yearbymonths:return this.ticks1year();case hv.chart.filter.last1yearbydays:return this.ticks1year();default:return[]}},ticks1year:function(){for(var i=[],r=getUTCDate(new Date(this.min)),n=new Date(r.getFullYear(),r.getMonth(),1),t=0;t<13;t++)this.options.showAlternateMonths&&t%2!=0||i.push([getLocalDate(n).getTime(),$.datepicker.formatDate("M",n)]),n.setMonth(n.getMonth()+1);return i},ticks6months:function(){for(var i=[],n=getUTCDate(new Date(this.min)),t=0;t<7;t++)i.push([getLocalDate(n).getTime(),$.datepicker.formatDate(hv.chart.resources.monthday,n)]),n.setMonth(n.getMonth()+1);return i},ticks90days:function(){for(var i=[],n=getUTCDate(new Date(this.min)),t=0;t<7;t++)i.push([getLocalDate(n).getTime(),$.datepicker.formatDate(hv.chart.resources.monthday,n)]),n.setDate(n.getDate()+15);return i},ticks30days:function(){for(var i=[],n=getUTCDate(new Date(this.min)),t=0;t<7;t++)i.push([getLocalDate(n).getTime(),$.datepicker.formatDate(hv.chart.resources.monthday,n)]),n.setDate(n.getDate()+5);return i},ticks7days:function(){for(var i=[],n=getUTCDate(new Date(this.min)),t=0;t<7;t++)i.push([getLocalDate(n).getTime(),$.datepicker.formatDate(hv.chart.resources.monthday,n)]),n.setDate(n.getDate()+1);return i}}),BarChartXAxis=ChartXAxis.extend({ticks1year:function(){var n=this.base();return this.min=this.min-1296e6,this.max=this.max-864e6,n},ticks90days:function(){return this.base()},ticks30days:function(){var n=this.base();return this.min=this.min-43e6,this.max=this.max-33e6,n},ticks7days:function(){var n=this.base();return this.min=this.min-43e6,this.max=this.max-33e6,n}}),ChartYAxis=Class.create({settings:{min:0,bottomPad:20,topPad:10,numLines:5,multipleOf:10,decimalPlaces:1,fixed:!1},position:"left",init:function(n){this.settings=$.extend({},this.settings,n)},onSuccess:function(n){this.update(n)},update:function(n){var u,i;if(n.data){var t=n.goal&&n.goal.chart&&n.goal.min?n.goal.min:999999999,r=n.goal&&n.goal.chart&&n.goal.max?n.goal.max:-1,f=n.data.length;for(u=0;u<f;u++)i=n.data[u][1],i<t&&(t=i),i>r&&(r=i);t=Math.max(this.settings.min,t-this.settings.bottomPad),r+=this.settings.topPad,this.min=this.settings.multipleOf*Math.floor(t/this.settings.multipleOf),this.max=this.settings.multipleOf*(Math.floor(r/this.settings.multipleOf)+1),this.ticks=this.getTicks()}},getTicks:function(){for(var n=[],r=(this.max-this.min)/this.settings.numLines,t=this.min,i=0;i<this.settings.numLines;i++)n.push([t,this.formatTick(t)]),t+=r;return n.push([this.max,this.formatTick(this.max)]),n},formatTick:function(n){var t=n.toFixed(this.settings.decimalPlaces);return this.settings.fixed||(t=(t*1).toString()),t}}),GraphTooltipper=Class.create({defaults:{tipId:"",tooltipTemplate:$(""),units:"",decimalPlaces:0,yoffset:10},init:function(n){this.options=$.extend({},this.defaults,n),this.defaultDateFormat=hv.chart.resources.shortmonthday},hover:function(n,t,i){var r=$("#"+this.options.tipId);i?(r.length===0&&(r=this.options.tooltipTemplate.clone(),r.attr("id",this.options.tipId)),this.format(r,i),this.position(r,t,i)):r.remove()},format:function(n,t){n.find(".chartTooltipItemDate").text(this.formatDate(t.datapoint[0])),n.find(".chartTooltipValue").text(this.formatValue(t))},position:function(n,t,i){var r=this.options.mouse?t.pageY:i.pageY,u=this.options.mouse?t.pageX:i.pageX;n.appendTo("body").fadeIn(200).css({top:r-n.height()-this.options.yoffset,left:u})},formatValue:function(n){return globalFloatToString(round(n.datapoint[1],this.options.decimalPlaces))+" "+this.options.units},formatDate:function(n){return $.datepicker.formatDate(this.defaultDateFormat,getUTCDate(new Date(n)))}}),ChartSwitcher=Class.create({active:0,init:function(n,t){this.charts=t,n.bind("plothover",{ref:this},this.plotHover)},activeChart:function(){return this.charts[this.active].chart},switchChart:function(n){for(var t=0;t<this.charts.length;t++)if(this.charts[t].id==n){this.active=t;break}},update:function(n){this.activeChart().update(n)},plotHover:function(n,t,i){n.data.ref.activeChart().plotHover(n,t,i)}}),ChartAjaxer=Class.create({init:function(n,t){this.elem=n,this.options=t;var i=this;this.elem.bind("hv.chart.filterchange",function(n,t){i.refresh(t)})},refresh:function(n){var t=this;t.elem.trigger("hv.chart.refreshInit"),$.ajax({type:"POST",url:t.options.url,cache:!1,dataType:"json",data:$.extend({chartType:t.options.chartType,filterType:n},g_antiForgeryToken),success:function(n){t.elem.trigger("hv.chart.refreshSuccess",[n])},error:function(){t.elem.trigger("hv.chart.refreshError")}})}}),ChartComponent=Class.create({init:function(n){this.children=n instanceof Array?n:[]},onInit:function(){this.callChildren("onInit")},onSuccess:function(n){this.callChildren("onSuccess",n)},onError:function(){this.callChildren("onError")},append:function(n){if(n instanceof Array)for(var t=0;t<n.length;t++)this.children.push(n[t]);else this.children.push(n)},callChildren:function(n,t){$.each(this.children,function(i,r){typeof r[n]=="function"&&r[n].call(r,t)})}}),GraphLoadingHelper=Class.create({timeoutHandle:null,init:function(n,t,i,r){this.chartArea=n,this.loadElem=t,this.emptyElem=i,this.errorElem=r},onInit:function(){var n=this;clearTimeout(n.timeoutHandle),n.timeoutHandle=setTimeout(function(){n.chartArea.hide(),n.emptyElem.hide(),n.errorElem.hide(),n.loadElem.show()},500)},onSuccess:function(n){clearTimeout(this.timeoutHandle),this.errorElem.hide(),this.loadElem.hide(),n.data?(this.emptyElem.hide(),this.chartArea.show()):(this.chartArea.hide(),this.emptyElem.show())},onError:function(){clearTimeout(this.timeoutHandle),this.chartArea.hide(),this.loadElem.hide(),this.emptyElem.hide(),this.errorElem.show()}}),ChartRefresher=ChartComponent.extend({init:function(n,t){this.options=n,this.base(t)},refresh:function(n){var t=this;t.onInit(),$.ajax({type:"POST",url:t.options.url,cache:!1,dataType:"json",data:$.extend({chartType:t.options.chartType,filterType:n},g_antiForgeryToken,t.options.data),success:function(n){t.onSuccess(n)},error:function(){t.onError()}})}}),BasicLineSeries=ChartComponent.extend({data:[],defaults:{removeHoverPlotNum:20},color:"#33CCFF",lines:{show:!0},points:{show:!0,radius:2,lineWidth:1,shadowSize:1},init:function(n){this.options=$.extend({},this.defaults,n),this.base()},onSuccess:function(n){n.data&&(this.points.radius=n.data.length<=this.options.removeHoverPlotNum?2:0,this.points.lineWidth=n.data.length<=this.options.removeHoverPlotNum?1:6,this.data=n.data)}}),BasicLineChart=ChartComponent.extend({crosshair:{mode:"x",color:"#CCC",lineWidth:.8},grid:{hoverable:!0,clickable:!0,borderWidth:0},init:function(n,t,i,r){this.elem=n,this.dataseries=r,this.xaxis=t,this.yaxis=i,this.base([this.xaxis,this.yaxis]),this.append(this.dataseries)},onSuccess:function(n){this.base(n),this.elem.empty();try{$.plot(this.elem,this.dataseries,this)}catch(t){}}});(function(n){n.fn.carousel=function(t){function s(){i.current>0&&(i.current--,f.addClass("enabled"),i.current<=0&&e.removeClass("enabled"),r.animate({left:"+="+i.itemWidth},"fast"))}function h(){i.current+i.shown<i.count&&(i.current++,e.addClass("enabled"),i.current+i.shown>=i.count&&f.removeClass("enabled"),r.animate({left:"-="+i.itemWidth},"fast"))}var r,u,o;if(!this||!this.length)return this;r=this.first(),u=n("<div class='carousel'><\/div>"),r.addClass("carouselContent"),o=0,r.children().each(function(){o+=n(this).outerWidth(!0)}),r.width(o),r.css("left",0),u.insertBefore(r),u.append(r);var e=n("<a href='javascript:void(0);' class='leftMover' title='"+t.leftText+"'><\/a>").prependTo(u),f=n("<a href='javascript:void(0);' class='rightMover' title='"+t.rightText+"'><\/a>").appendTo(u),i={width:u.width(),count:r.children().length,itemWidth:r.children().first().outerWidth(!0),current:0};i.shown=Math.round(i.width/i.itemWidth),i.shown<i.width&&f.addClass("enabled"),f.click(function(){f.is(".enabled")&&h()}),e.click(function(){e.is(".enabled")&&s()}),r.children().each(function(t){n(this).focusin(function(){if(i.current>t)while(i.current>t)s();else if(i.current+i.shown<=t)while(i.current+i.shown<=t)h()})}),u.scroll(function(){n(this).scrollLeft(0)})}})(jQuery);